# 마스터 관리 페이지 – 배포·SQL·접속 방법

## 1. 배포하기

코드를 GitHub에 올리면 Vercel이 자동으로 빌드·배포합니다.

```bash
git add .
git commit -m "마스터 관리 페이지 추가"
git push origin main
```

- Vercel이 연결되어 있으면 푸시 후 몇 분 안에 배포 완료됩니다.
- 빌드 시 `scripts/migrate.js`가 실행되어 `companies.is_master` 컬럼이 없으면 자동으로 추가됩니다.

---

## 2. SQL 실행해서 마스터 회사 지정하기

**한 번만** 실행하면 됩니다. 마스터로 쓸 **회사**를 DB에서 지정합니다.

### Vercel Postgres를 쓰는 경우 (권장)

1. [Vercel](https://vercel.com) 로그인 → 해당 프로젝트 선택
2. 상단 **Storage** 탭 → 사용 중인 **Postgres** DB 클릭
3. **Query** 탭에서 아래 SQL 실행

```sql
-- 기존 마스터 전부 해제
UPDATE companies SET is_master = false;

-- 마스터로 쓸 회사만 true (id를 원하는 회사 id로 변경)
UPDATE companies SET is_master = true WHERE id = 1;
```

- `id = 1` 대신 **회사 코드**로 하려면:  
  `UPDATE companies SET is_master = true WHERE code = '원하는회사코드';`
- 회사 id/코드는 먼저 `SELECT id, code, name FROM companies;` 로 확인할 수 있습니다.

### 로컬에서 스크립트로 실행하는 경우

프로젝트 루트에서:

```bash
node scripts/run-sql-file.js sql/set_master_company.sql
```

실행 전에 `sql/set_master_company.sql` 안의 `WHERE id = 1` 부분을 원하는 회사 id로 수정하세요.

---

## 3. 마스터 관리 페이지 들어가는 방법

1. **배포된 사이트**에 접속  
   예: `https://interior-erp-v2.vercel.app` (실제 주소는 Vercel에서 확인)

2. **마스터로 지정한 회사**로 로그인  
   - 그 회사의 구글 계정(이메일)으로 로그인해야 합니다.

3. 로그인 후 상단/사이드 메뉴에서  
   - **관리** 를 누르면 하위에 **마스터 관리** 가 보입니다.  
   - **마스터 관리** 를 클릭하면 마스터 관리 페이지로 이동합니다.

4. **URL로 직접 들어가기**  
   - 주소: `https://배포주소/admin/master`  
   - 예: `https://interior-erp-v2.vercel.app/admin/master`  
   - 마스터가 **아닌** 회사로 로그인한 상태면 이 주소로 가도 자동으로 `/admin` 으로 이동합니다.

---

## 요약

| 단계 | 내용 |
|------|------|
| 배포 | `git push origin main` → Vercel 자동 배포 |
| SQL | Vercel Storage → Postgres → Query에서 `UPDATE companies SET is_master = true WHERE id = 원하는id;` 실행 |
| 접속 | 마스터 회사 계정으로 로그인 → **관리** → **마스터 관리** 또는 `/admin/master` |

마스터 메뉴와 페이지는 **마스터로 지정된 회사로 로그인했을 때만** 보이고 접근할 수 있습니다.
